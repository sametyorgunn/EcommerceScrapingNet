@{
    ViewData["Title"] = "Index";
	Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<div class="card">
	<div class="card-header border-0 pt-6">
		<div class="card-title">
			<div class="d-flex align-items-center position-relative my-1">
				<span class="svg-icon svg-icon-1 position-absolute ms-6">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
						<rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="black"></rect>
						<path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="black"></path>
					</svg>
				</span>
				<input type="text" data-kt-user-table-filter="search" class="form-control form-control-solid w-250px ps-14" placeholder="Search user">
			</div>
		</div>
		<div class="card-toolbar">
			<div class="d-flex justify-content-end" data-kt-user-table-toolbar="base">
				<button type="button" class="btn btn-light-primary me-3" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
					<span class="svg-icon svg-icon-2">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
							<path d="M19.0759 3H4.72777C3.95892 3 3.47768 3.83148 3.86067 4.49814L8.56967 12.6949C9.17923 13.7559 9.5 14.9582 9.5 16.1819V19.5072C9.5 20.2189 10.2223 20.7028 10.8805 20.432L13.8805 19.1977C14.2553 19.0435 14.5 18.6783 14.5 18.273V13.8372C14.5 12.8089 14.8171 11.8056 15.408 10.964L19.8943 4.57465C20.3596 3.912 19.8856 3 19.0759 3Z" fill="black"></path>
						</svg>
					</span>
					Filter
				</button>
				<div class="menu menu-sub menu-sub-dropdown w-300px w-md-325px" data-kt-menu="true">
					<div class="px-7 py-5">
						<div class="fs-5 text-dark fw-bolder">Filter Options</div>
					</div>
					<div class="separator border-gray-200"></div>
					<div class="px-7 py-5" data-kt-user-table-filter="form">
						<div class="mb-10">
							<label class="form-label fs-6 fw-bold">Role:</label>
							<select class="form-select form-select-solid fw-bolder select2-hidden-accessible" data-kt-select2="true" data-placeholder="Select option" data-allow-clear="true" data-kt-user-table-filter="role" data-hide-search="true" data-select2-id="select2-data-10-sqk2" tabindex="-1" aria-hidden="true">
								<option data-select2-id="select2-data-12-nrx8"></option>
								<option value="Administrator">Administrator</option>
								<option value="Analyst">Analyst</option>
								<option value="Developer">Developer</option>
								<option value="Support">Support</option>
								<option value="Trial">Trial</option>
							</select><span class="select2 select2-container select2-container--bootstrap5" dir="ltr" data-select2-id="select2-data-11-jwcx" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--single form-select form-select-solid fw-bolder" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-3gy7-container" aria-controls="select2-3gy7-container"><span class="select2-selection__rendered" id="select2-3gy7-container" role="textbox" aria-readonly="true" title="Select option"><span class="select2-selection__placeholder">Select option</span></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
						</div>
						<div class="mb-10">
							<label class="form-label fs-6 fw-bold">Two Step Verification:</label>
							<select class="form-select form-select-solid fw-bolder select2-hidden-accessible" data-kt-select2="true" data-placeholder="Select option" data-allow-clear="true" data-kt-user-table-filter="two-step" data-hide-search="true" data-select2-id="select2-data-13-rawl" tabindex="-1" aria-hidden="true">
								<option data-select2-id="select2-data-15-sq52"></option>
								<option value="Enabled">Enabled</option>
							</select><span class="select2 select2-container select2-container--bootstrap5" dir="ltr" data-select2-id="select2-data-14-n5ep" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--single form-select form-select-solid fw-bolder" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-v6vq-container" aria-controls="select2-v6vq-container"><span class="select2-selection__rendered" id="select2-v6vq-container" role="textbox" aria-readonly="true" title="Select option"><span class="select2-selection__placeholder">Select option</span></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
						</div>
						<div class="d-flex justify-content-end">
							<button type="reset" class="btn btn-light btn-active-light-primary fw-bold me-2 px-6" data-kt-menu-dismiss="true" data-kt-user-table-filter="reset">Reset</button>
							<button type="submit" class="btn btn-primary fw-bold px-6" data-kt-menu-dismiss="true" data-kt-user-table-filter="filter">Apply</button>
						</div>
					</div>
				</div>
				
				<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#kt_modal_add_user">
					<span class="svg-icon svg-icon-2">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
							<rect opacity="0.5" x="11.364" y="20.364" width="16" height="2" rx="1" transform="rotate(-90 11.364 20.364)" fill="black"></rect>
							<rect x="4.36396" y="11.364" width="16" height="2" rx="1" fill="black"></rect>
						</svg>
					</span>
					Ürünleri Çek
				</button>
			</div>
			<div class="d-flex justify-content-end align-items-center d-none" data-kt-user-table-toolbar="selected">
				<div class="fw-bolder me-5">
					<span class="me-2" data-kt-user-table-select="selected_count"></span>Selected
				</div>
				<button type="button" class="btn btn-danger" data-kt-user-table-select="delete_selected">Delete Selected</button>
			</div>
			
			<div class="modal fade" id="kt_modal_add_user" tabindex="-1" aria-hidden="true">
				<div class="modal-dialog modal-dialog-centered mw-650px">
					<div class="modal-content">
						<div class="modal-header" id="kt_modal_add_user_header">
							<h2 class="fw-bolder">Ürünleri Çek</h2>
							<div class="btn btn-icon btn-sm btn-active-icon-primary" data-kt-users-modal-action="close">
								<span class="svg-icon svg-icon-1">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
										<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="black"></rect>
										<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="black"></rect>
									</svg>
								</span>
							</div>
						</div>
						<div class="modal-body scroll-y mx-5 mx-xl-15 my-7">
							<form method="post" id="kt_modal_add_user_form" class="form fv-plugins-bootstrap5 fv-plugins-framework">
								<div class="d-flex flex-column scroll-y me-n7 pe-7" id="kt_modal_add_user_scroll" data-kt-scroll="true" data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-max-height="auto" data-kt-scroll-dependencies="#kt_modal_add_user_header" data-kt-scroll-wrappers="#kt_modal_add_user_scroll" data-kt-scroll-offset="300px" style="max-height: 127px;">
									<div class="fv-row mb-7 fv-plugins-icon-container">
										<label class="required fw-bold fs-6 mb-2">Kategori</label>

										@await Component.InvokeAsync("CategoryListForDropdown")
										<br />
@*  										@await Component.InvokeAsync("TrendyolCategories")
 *@ 

										<div class="fv-plugins-message-container invalid-feedback"></div>
										<br />
										<label class="required fw-bold fs-6 mb-2">Ürün Adı</label>
										<input id="ProductName" name="ProductName" value="" class="form-control fw-bold fs-6 mb-2">Ürün Adı</input>
									</div>
								</div>
								<div class="text-center pt-15">
									<button type="reset" class="btn btn-light me-3" data-kt-users-modal-action="cancel">Vazgeç</button>
									<div type="" id="scrapeProd" class="btn btn-primary">
										<span class="indicator-label">Ürünleri Çek</span>
										<span class="indicator-progress">
											Lütfen Bekleyin...
											<span class="spinner-border spinner-border-sm align-middle ms-2"></span>
										</span>
									</div>
								</div>
								<div></div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="card-body pt-0">
		<div id="kt_table_users_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">
			<div class="table-responsive">

				@await Component.InvokeAsync("ProductList")

			</div><div class="row"><div class="col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"></div><div class="col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"><div class="dataTables_paginate paging_simple_numbers" id="kt_table_users_paginate"><ul class="pagination"><li class="paginate_button page-item previous disabled" id="kt_table_users_previous"><a href="#" aria-controls="kt_table_users" data-dt-idx="0" tabindex="0" class="page-link"><i class="previous"></i></a></li><li class="paginate_button page-item active"><a href="#" aria-controls="kt_table_users" data-dt-idx="1" tabindex="0" class="page-link">1</a></li><li class="paginate_button page-item "><a href="#" aria-controls="kt_table_users" data-dt-idx="2" tabindex="0" class="page-link">2</a></li><li class="paginate_button page-item "><a href="#" aria-controls="kt_table_users" data-dt-idx="3" tabindex="0" class="page-link">3</a></li><li class="paginate_button page-item next" id="kt_table_users_next"><a href="#" aria-controls="kt_table_users" data-dt-idx="4" tabindex="0" class="page-link"><i class="next"></i></a></li></ul></div></div></div>
		</div>
	</div>
</div>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<script>
    $("#scrapeProd").click(function () {
		toastr.success("ürünler çekiliyor lütfen bekleyiniz !!!")
		var CategoryId = $("#CategoryName").val();
		var ProductName = $("#ProductName").val();
		var data = {
			CategoryId: CategoryId,
            ProductName: ProductName
		}
        $.ajax({
			url: "/Admin/ProductComment/ScrapeProduct",
            type: "POST",
            data: data,
            success: function (response) {
                if (response.status == "True") {
					toastr.success("ürünler Başarıyla çekildi.")
					window.location.reload();
                } else {
					toastr.error("ürünler çekilemedi.")
                }
            },
            error: function (error) {
                console.log(error);
            }
        });
    });	
</script>